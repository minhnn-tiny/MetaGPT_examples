{"Language":"en_us","Programming Language":"Python","Original Requirements":"All submissions for this problem are available.\n\nBattle of the Chefs is coming up! It's a contest where different teams of different Chefs compete against each other. Our Chef wants to send one of the best teams from his entire staff. Selecting a good team is not about having the best people, but it is about having members who can cooperate and work well with each other. Chef is very aware of this fact. So he chooses the following strategy to decide a team. He lines up all his N cooks in a line. Each of these cooks has a skill level associated with him. Denote the level of the i-th cook as skill[i] for 1 ≤ i ≤ N. Let us make a few points on a team formation.\n\nA team can have any number of cooks.\nEach team should consist of consecutive cooks. So, for example, cooks with positions 3, 4, 5 can form a team, but cooks with positions 4, 5, 7, 8 can not.\nA team is a candidate team if the difference between the maximum skill and the minimum skill of the cooks in the team does not exceed the threshold C.\nA cook can be in 0 or more candidate teams. Which means that candidate teams can intersect.\nTwo candidate teams are considered to be different if there exists at least one cook who is in one team but not in the other.\n\n\nChef has not yet decided the team of what size he is going to send to the battle. To be precise we note, that the team size is the total number of cooks in it. For the given team size Chef wants to consider all candidate teams of this size according to the rules described above, evaluate them for himself and choose the best one. Denote the total number of candidate teams for the given size K as cand[K]. To increase the chances of choosing better team he wants the number of candidate teams to be as large as possible. But Chef is a human and can't evaluate too many teams. The maximal number of teams he can evaluate depends on many factors such as his mood or fatigue. We call it the Chef's limit. Denote the current Chef's limit as M. Since Chef still wants the total number of candidate teams to be as large as possible you need to find the team size K such that cand[K] ≤ M, among all such K find the value for which cand[K] is maximal and if such K is not unique find the minimal K among them. Since Chef's limit always changes according to his mood or fatigue you should find the required team size for several values of M. Chef also wants to know the total number of candidate teams for the size you will find. There will be Q values of M in all.\n\n\nIn order to keep the input small the skills of the cooks will be given in the following way.\n\nSkills of the first X cooks are given in the input, where X = min(10000, N).\nIf N > 10000 skills of the remaining cooks for 10000 < i ≤ N are calculated as\nskill[i] = (A * skill[i-1] + B * skill[i-2] + D) mod 230,\nwhere A, B and D are given in the input. Here mod denotes the modulo operation, that is, Y mod Z is the remainder of division of Y by Z.\n\nInput\n\nThe first line of the input contains a single integer T, the number of test cases to follow.\nEach test case consists of 3 lines.\nThe first line contains 6 space-separated integers N, C, Q, A, B and D.\nThe second line contains X = min(N, 10000) space-separated integers, i-th integer among them represents the skill of the i-th cook, that is, the number skill[i].\nThe third line contains Q space-separated integers, the values of M for which you need to find the optimal team size and the number of candidate teams of this size.\n\nOutput\n\nFor each test case, output Q lines containing the optimal team size for the corresponding value of M and the number of candidate teams corresponding to this team size separated by a space.\n\nConstraints\n\n1 ≤ T ≤ 5\n1 ≤ N ≤ 500000\n0 ≤ C < 230\n1 ≤ Q ≤ 1000\n0 ≤ A, B, D < 230\n0 ≤ skill[i] < 230 for 1 ≤ i ≤ X\n1 ≤ M ≤ N\n\nExample\n\nInput:\n2\n6 3 3 1 1 1\n6 2 4 5 6 3\n4 3 6\n6 10 1 2 2 2\n1 1000 1 1000 1 1000\n4\n\nOutput:\n2 4\n3 3\n1 6\n2 0\nExplanation\n\nCase 1.\nWith team size 2, we have 4 candidate teams: {2, 4}, {4, 5}, {5, 6}, and {6, 3}. Here numbers denote the cooks' skills. With any other team size, the number of candidate teams is either less than 4 or greater than 4.\nSimilarly, with team size 3, we have 3 candidate teams, which are {2, 4, 5}, {4, 5, 6} and {5, 6, 3}.\nWith team size 1, we have 6 candidate teams with one member in each team.\n\n\nCase 2.\nWith team size 1, we have 6 possible candidate teams. But 6 > 4. For all other team sizes, the total number of candidate teams is 0. Thus, the answer is the smallest size among them, i.e., 2.","Project Name":"battle_of_the_chefs","Product Goals":["Create a team of cooks that can work well together","Maximize the number of candidate teams","Find the optimal team size for a given Chef's limit"],"User Stories":["As a Chef, I want to be able to select a team of cooks that can work well together","As a Chef, I want to be able to find the optimal team size for a given Chef's limit","As a Chef, I want to be able to maximize the number of candidate teams"],"Competitive Analysis":[],"Competitive Quadrant Chart":"","Requirement Analysis":"The requirements are well-defined and clear. The problem is to find the optimal team size for a given Chef's limit, while maximizing the number of candidate teams. The problem can be solved using a dynamic programming approach.","Requirement Pool":[["P0","Find the optimal team size for a given Chef's limit"],["P0","Maximize the number of candidate teams"]],"UI Design draft":"","Anything UNCLEAR":""}